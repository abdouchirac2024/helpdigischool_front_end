# =============================================================================
# Help Digi School - Prometheus Configuration
# =============================================================================

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  scrape_timeout: 10s

# =============================================================================
# Alertmanager (optionnel)
# =============================================================================
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#           - alertmanager:9093

# =============================================================================
# Regles d'alerte (optionnel)
# =============================================================================
# rule_files:
#   - "rules/*.yml"

# =============================================================================
# Scrape Configurations
# =============================================================================
scrape_configs:
  # ---------------------------------------------------------------------------
  # Prometheus - Auto-monitoring
  # ---------------------------------------------------------------------------
  - job_name: "prometheus"
    static_configs:
      - targets: ["localhost:9090"]
        labels:
          service: "prometheus"
          environment: "monitoring"

  # ---------------------------------------------------------------------------
  # Node Exporter - Metriques systeme (CPU, RAM, disque, reseau)
  # ---------------------------------------------------------------------------
  - job_name: "node-exporter"
    static_configs:
      - targets: ["node-exporter:9100"]
        labels:
          service: "node-exporter"
          environment: "monitoring"

  # ---------------------------------------------------------------------------
  # Help Digi School Frontend - Metriques applicatives
  # ---------------------------------------------------------------------------
  - job_name: "helpdigischool-frontend"
    metrics_path: "/api/metrics"
    static_configs:
      - targets: ["host.docker.internal:3000"]
        labels:
          service: "helpdigischool-frontend"
          environment: "development"

  # ---------------------------------------------------------------------------
  # Loki - Metriques du systeme de logs
  # ---------------------------------------------------------------------------
  - job_name: "loki"
    static_configs:
      - targets: ["loki:3100"]
        labels:
          service: "loki"
          environment: "monitoring"

  # ---------------------------------------------------------------------------
  # Grafana - Metriques du dashboard
  # ---------------------------------------------------------------------------
  - job_name: "grafana"
    static_configs:
      - targets: ["grafana:3000"]
        labels:
          service: "grafana"
          environment: "monitoring"

  # ---------------------------------------------------------------------------
  # Traefik - Metriques du reverse proxy
  # ---------------------------------------------------------------------------
  - job_name: "traefik"
    static_configs:
      - targets: ["traefik-dev:8080"]
        labels:
          service: "traefik"
          environment: "infrastructure"

  # ---------------------------------------------------------------------------
  # DigiSchool Backend - Metriques Spring Boot / JVM
  # ---------------------------------------------------------------------------
  - job_name: "digischool-backend"
    metrics_path: "/actuator/prometheus"
    static_configs:
      - targets: ["digischool-backend:8080"]
        labels:
          service: "digischool-backend"
          environment: "backend"
